import { allBlogs } from 'contentlayer/generated';
import { useMDXComponent } from 'next-contentlayer/hooks';
import { format } from 'date-fns';
import Head from 'next/head';
import { useRouter } from 'next/router';

export async function getStaticPaths() {
  return {
    paths: allBlogs.map((post) => ({ params: { slug: post.slug } })),
    fallback: false,
  };
}

export async function getStaticProps({ params }) {
  const post = allBlogs.find((post) => post.slug === params.slug);
  return { props: { post } };
}

export default function BlogPost({ post }) {
  const Component = useMDXComponent(post.body.code);
  const router = useRouter();

  return (
    <main className="max-w-3xl mx-auto px-4 sm:px-6 py-16 text-gray-800">
      <Head>
        <title>{post.title} â€“ Glodinas Finance</title>
        <meta name="description" content={post.description} />
        <meta property="og:title" content={post.title} />
        <meta property="og:description" content={post.description} />
        <meta property="og:url" content={`https://www.glodinasfinance.nl${router.asPath}`} />
      </Head>

      <h1 className="text-4xl font-bold mb-2 text-gray-900">{post.title}</h1>
      <p className="text-sm text-gray-500 mb-6">{format(new Date(post.date), 'dd MMMM yyyy')}</p>

      <article className="prose prose-blue max-w-none">
        <Component />
      </article>
    </main>
  );
}